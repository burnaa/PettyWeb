<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bla bla">
    <link rel="stylesheet" href="../styles/prod.css">
    <link rel="stylesheet" href="../styles/cartDialog.css">
    <script src="../components/my-footer.js" type="module"></script>
    <script src="../components/my-header.js" type="module"></script>
    <title>products</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Shade&family=Caveat:wght@400..700&display=swap"
        rel="stylesheet">
    <script src="../components/main-product.js" type="module"></script>

    <script>
        let products = []; // –ë“Ø—Ö –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥–∏–π–≥ —Ö–∞–¥–≥–∞–ª–∞—Ö –º–∞—Å—Å–∏–≤

        function toggleSelection(element) {
            element.classList.toggle('selected');
            filterProduct();
        }

        async function fetchProducts() {
            try {
                const response = await fetch('http://localhost:3000/products'); // –°–µ—Ä–≤–µ—Ä–∏–π–Ω URL
                if (!response.ok) {
                    throw new Error(`Failed to fetch products: ${response.statusText}`);
                }

                const data = await response.json();
                products = data.map(item => ({
                    id: item.prod_id,
                    name: item.prod_name || "–ù—ç—Ä–≥“Ø–π",
                    code: item.prod_code || "–ö–æ–¥–≥“Ø–π",
                    type: item.prod_type || "–¢”©—Ä”©–ª–≥“Ø–π",
                    animal: item.prod_animal || "–ê–º—å—Ç–Ω—ã —Ç”©—Ä”©–ª –±–∞–π—Ö–≥“Ø–π",
                    size: item.prod_size || "–•—ç–º–∂—ç—ç–≥“Ø–π",
                    colors: item.prod_color || "”®–Ω–≥”©–≥“Ø–π",
                    origin: item.origin || "–ì–∞—Ä–∞–ª “Ø“Ø—Å—ç–ª–≥“Ø–π",
                    certification: item.certification || "–¢–∏–π–º",
                    start_date: item.start_date || "–≠—Ö–ª—ç—Ö –æ–≥–Ω–æ–æ –±–∞–π—Ö–≥“Ø–π",
                    end_date: item.end_date || "–î—É—É—Å–∞—Ö –æ–≥–Ω–æ–æ –±–∞–π—Ö–≥“Ø–π",
                    piece: item.piece || "–¢–æ–æ —à–∏—Ä—Ö—ç–≥–≥“Ø–π",
                    price: item.price || "“Æ–Ω–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª –±–∞–π—Ö–≥“Ø–π",
                    images: item.subpic || "../images/default.jpg"
                }));

                render(products); // –ë“Ø—Ö –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥–∏–π–≥ —ç—Ö–ª—ç—ç–¥ —Ö–∞—Ä—É—É–ª–∞—Ö
            } catch (error) {
                console.error("Error fetching products:", error.message);
            }
        }


        function filterProduct() {
            // –°–æ–Ω–≥–æ–≥–¥—Å–æ–Ω –±“Ø—Ö `type` –±–æ–ª–æ–Ω `animal` —ç–ª–µ–º–µ–Ω—Ç“Ø“Ø–¥–∏–π–Ω `pre` –¥–æ—Ç–æ—Ä—Ö —Ç–µ–∫—Å—Ç–∏–π–≥ –º–∞—Å—Å–∏–≤ –±–æ–ª–≥–æ–Ω –∞–≤–Ω–∞
            const selectedCheckboxes = Array.from(document.querySelectorAll('.type.selected pre'))
                .map(pre => pre.textContent.trim());

            // –•—ç—Ä—ç–≤ —è–º–∞—Ä —á —Å–æ–Ω–≥–æ–ª—Ç –±–∞–π—Ö–≥“Ø–π –±–æ–ª –±“Ø—Ö –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥–∏–π–≥ —Ö–∞—Ä—É—É–ª–Ω–∞
            if (selectedCheckboxes.length === 0) {
                render(products);
                return;
            }

            // –°–æ–Ω–≥–æ–≥–¥—Å–æ–Ω `type` —ç–ª–µ–º–µ–Ω—Ç“Ø“Ø–¥–∏–π–≥ —à“Ø“Ø–∂ —Ö–∞–¥–≥–∞–ª–∞—Ö
            const selectedTypes = selectedCheckboxes.filter(type =>
                ["–•–æ–æ–ª", "–ì–æ—ë–ª —á–∏–º—ç–≥–ª—ç–ª", "–ê—Ä–∏—É–Ω —Ü—ç–≤—ç—Ä", "–¢–æ–≥–ª–æ–æ–º", "–£–Ω—Ç–∞—Ö —Ö—ç—Ä—ç–≥—Å—ç–ª", "–¢—ç—ç–≤—ç—Ä–ª—ç—Ö —Å–∞–≤"].includes(type)
            );

            // –°–æ–Ω–≥–æ–≥–¥—Å–æ–Ω `animal` —ç–ª–µ–º–µ–Ω—Ç“Ø“Ø–¥–∏–π–≥ —à“Ø“Ø–∂ —Ö–∞–¥–≥–∞–ª–∞—Ö
            const selectedAnimals = selectedCheckboxes.filter(type =>
                ["–ù–æ—Ö–æ–π", "–ú—É—É—Ä", "–¢—É—É–ª–∞–π", "–ó–∞–≥–∞—Å", "–®—É–≤—É—É", "–ë—É—Å–∞–¥"].includes(type)
            );

            // –¢”©—Ä–ª”©”©—Ä —à“Ø“Ø—Ö
            const typeFiltered = selectedTypes.length > 0
                ? products.filter(product => selectedTypes.includes(product.type))
                : products;

            // –ê–º—å—Ç–Ω—ã —Ç”©—Ä”©–ª–¥ —Ç–æ—Ö–∏—Ä–æ—Ö –±–∞–π–¥–ª–∞–∞—Ä —à“Ø“Ø—Ö
            const finalFilteredProducts = selectedAnimals.length > 0
                ? typeFiltered.filter(product => selectedAnimals.includes(product.animal))
                : typeFiltered;

            // –®“Ø“Ø—Å—ç–Ω –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥–∏–π–≥ —Ö–∞—Ä—É—É–ª–∞—Ö
            render(finalFilteredProducts);
        }


        function render(data) {
            const container = document.getElementById('filter-product');
            if (!container) {
                console.error('Container "#filter-product" not found in DOM!');
                return;
            }

            const html = data.reduce((acc, item) => {
                return acc + `
                    <article class="product11" onclick="showProductDetails('${item.id}')">
                        <h3>${item.name}</h3>
                        <img src="${item.images}" alt="${item.name}" class="product-image">
                        <p>“Æ–Ω—ç: ${item.price}‚ÇÆ</p>
                    </article>`;
            }, '');

            container.innerHTML = html;
        }



        function showProductDetails(productID) {
    const container = document.getElementById('one-product');
    container.innerHTML = ''; // –•—É—É—á–∏–Ω –∫–æ–Ω—Ç–µ–Ω—Ç—ã–≥ —Ü—ç–≤—ç—Ä–ª—ç—Ö

    // –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ö–∞–π–∂ –æ–ª–æ—Ö
    const product = products.find(p => p.id === productID);

    if (!product) {
        container.innerHTML = '<p>–ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω –æ–ª–¥—Å–æ–Ω–≥“Ø–π.</p>';
        return;
    }

    // –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –≥–∞—Ä–≥–∞—Ö HTML-–≥ “Ø“Ø—Å–≥—ç—Ö
    const productHTML = `
        <div class="container">
            <div id="mainpicture">
                <img class="big" src="${product.images}" alt="Main Product Image">
            </div>
            <article>
                <h2 id="title">${product.name}</h2>
                <pre>${product.type}</pre>
                <pre>–•—ç–º–∂—ç—ç: ${product.size} </pre>
                <aside class="songolt">
                    <pre>”®–Ω–≥”©</pre>
                    <form>
                        ${product.colors.split(',').map((color, index) => `
                            <input type="radio" name="choice_color" id="color${index + 1}" ${index === 0 ? 'checked' : ''}>
                            <label for="color${index + 1}">${color}</label>
                        `).join('')}
                    </form>
                </aside>
                <p id="uildverlesen">“Æ–π–ª–¥–≤—ç—Ä–ª—ç–≥–¥—Å—ç–Ω –æ–≥–Ω–æ–æ: ${product.start_date}</p>
                <p id="expire">–î—É—É—Å–∞—Ö –æ–≥–Ω–æ–æ: ${product.end_date}</p>
                <p id="origin">–ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π –≥–∞—Ä–∞–ª: ${product.origin}</p>
                <p id="standart">–ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç: ${product.certification}</p>
                <span id="currency">${product.price}‚ÇÆ</span>
                <br>
                <button id="cart-button">üõí–°–∞–≥—Å–∞–Ω–¥ –Ω—ç–º—ç—Öüõí</button>
            </article>
        </div>`;

    // –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—Ç –æ—Ä—É—É–ª–∞—Ö
    container.innerHTML = productHTML;
}

        document.addEventListener('DOMContentLoaded', function () {
            render(products); // –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥–∏–π–≥ —ç—Ö–ª—ç—ç–¥ —Ö–∞—Ä—É—É–ª–∞—Ö
            fetchProducts(); // ”®–≥”©–≥–¥–ª–∏–π–≥ —Ç–∞—Ç–∞–∂ —ç—Ö–ª“Ø“Ø–ª—ç—Ö
        });

    </script>

</head>

<body>
    <my-header></my-header>
    <main class="types">
        <aside class="zereg">
            <h3>–ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π —Ç”©—Ä”©–ª</h3>
            <a href="../htmls/admins.html" aria-label="–ê–¥–º–∏–Ω –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω –Ω—ç–º—ç—Ö">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="#d4202e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-square-plus">
                    <rect width="18" height="18" x="3" y="3" rx="2" />
                    <path d="M8 12h8" />
                    <path d="M12 8v8" />
                </svg>
            </a>
        </aside>
        <hr>
        <aside class="type" onclick="toggleSelection(this)">
            <svg class="paw1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-paw-print">
                <circle cx="11" cy="4" r="2" />
                <circle cx="18" cy="8" r="2" />
                <circle cx="20" cy="16" r="2" />
                <path
                    d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
            </svg>
            <pre id="food">–•–æ–æ–ª</pre>
            <img src="../images/type1.png" alt="—Ö–æ–æ–ª">
        </aside>
        <aside class="type" onclick="toggleSelection(this)">
            <svg class="paw1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-paw-print">
                <circle cx="11" cy="4" r="2" />
                <circle cx="18" cy="8" r="2" />
                <circle cx="20" cy="16" r="2" />
                <path
                    d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
            </svg>
            <pre>–ì–æ—ë–ª —á–∏–º—ç–≥–ª—ç–ª</pre>
            <img src="../images/type2 (2).png" alt="–≥–æ—ë–ª">
        </aside>
        <aside class="type" onclick="toggleSelection(this)">
            <svg class="paw1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-paw-print">
                <circle cx="11" cy="4" r="2" />
                <circle cx="18" cy="8" r="2" />
                <circle cx="20" cy="16" r="2" />
                <path
                    d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
            </svg>
            <pre>–ê—Ä–∏—É–Ω —Ü—ç–≤—ç—Ä</pre>
            <img src="../images/type3 (2).png" alt="–∞—Ä–∏—É–Ω —Ü—ç–≤—ç—Ä">

        </aside>
        <aside class="type" onclick="toggleSelection(this)">
            <svg class="paw1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-paw-print">
                <circle cx="11" cy="4" r="2" />
                <circle cx="18" cy="8" r="2" />
                <circle cx="20" cy="16" r="2" />
                <path
                    d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
            </svg>
            <pre>–¢–æ–≥–ª–æ–æ–º</pre>
            <img src="../images/type4.png" alt="—Ç–æ–≥–ª–æ–æ–º">

        </aside>
        <aside class="type" onclick="toggleSelection(this)">
            <svg class="paw1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-paw-print">
                <circle cx="11" cy="4" r="2" />
                <circle cx="18" cy="8" r="2" />
                <circle cx="20" cy="16" r="2" />
                <path
                    d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
            </svg>
            <pre>–£–Ω—Ç–∞—Ö —Ö—ç—Ä—ç–≥—Å—ç–ª</pre>
            <img src="../images/type5.png" alt="–≥–æ—ë–ª">
        </aside>
        <aside class="type" onclick="toggleSelection(this)">
            <svg class="paw1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-paw-print">
                <circle cx="11" cy="4" r="2" />
                <circle cx="18" cy="8" r="2" />
                <circle cx="20" cy="16" r="2" />
                <path
                    d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
            </svg>
            <pre>–¢—ç—ç–≤—ç—Ä–ª—ç—Ö —Å–∞–≤</pre>
            <img src="../images/type6.png" alt="–≥–æ—ë–ª">

        </aside>

        <aside class="type" onclick="toggleSelection(this)">
            <pre id="dog">–ù–æ—Ö–æ–π</pre>
            <img src="../images/dog team-Photoroom.png" alt="—Ö–æ–æ–ª">
        </aside>

        <aside class="type" onclick="toggleSelection(this)">
            <pre id="cat">–ú—É—É—Ä</pre>
            <img src="../images/hhjj-Photoroom.png" alt="–≥–æ—ë–ª">
        </aside>

        <aside class="type" onclick="toggleSelection(this)">
            <pre id="rabbit">–¢—É—É–ª–∞–π</pre>
            <img src="../images/rra-Photoroom.png" alt="–∞—Ä–∏—É–Ω —Ü—ç–≤—ç—Ä">
        </aside>

        <aside class="type" onclick="toggleSelection(this)">
            <pre id="fish">–ó–∞–≥–∞—Å</pre>
            <img src="../images/fifi-Photoroom.png" alt="—Ç–æ–≥–ª–æ–æ–º">
        </aside>

        <aside class="type" onclick="toggleSelection(this)">
            <pre id="bird">–®—É–≤—É—É</pre>
            <img src="../images/bibi-Photoroom.png" alt="–≥–æ—ë–ª">
        </aside>
        <aside class="type" onclick="toggleSelection(this)">
            <pre id="other">–ë—É—Å–∞–¥</pre>
            <img src="../images/oth-Photoroom.png" alt="–≥–æ—ë–ª">

        </aside>
        <hr>

        <aside id="filter-product">

        </aside>

        <aside id="one-product">
            <!-- –≠–Ω–¥ –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥ –¥–∏–Ω–∞–º–∏–∫–∞–∞—Ä —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞ -->
        </aside>

    </main>
    <my-footer></my-footer>

</body>

</html>